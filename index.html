---
layout: default
title: Stream to Github
---
Streamdata Key: <input type="text" name="streamdataKey" id="feedlytoken" value="">
<br />
News API Key: <input type="text" name="newsAPIKey" id="feedlytoken" value="">
<br />
<input type="button" name="run" value="run" onclick="runit();">
<script>


function processResults(results)
	{

	console.log(results);

	}

function runit()
	{
  var eventSource = null;
  var stocks = [];
  var checked = 1;

  function connect() {

		var $streamdataKey = document.getElementById("streamdataKey").value;
		console.log("streamdata key: " + $streamdataKey);

		var $newsAPIKey = document.getElementById("newsAPIKey").value;
		console.log("newsapi key: " + $newsAPIKey);

		var $api_url = 'http://newsapi.org/v2/top-headlines';
		console.log("newsapi url: " + $api_url);

    // create the StreamdataEventSource Object
    eventSource = streamdataio.createEventSource($api_url, $streamdataKey);

    eventSource
     .onOpen(function() {
       console.log("streamdata Event Source connected.")
     })
     .onData(function(data) {

       results = sortByKey(data, 'calldatetime');
	   processResults(results);

	   document.getElementById('checked').innerHTML = "Updated " + checked + ' time!';

     })
     .onPatch(function(patch) {

       // use json patch library to apply the patch (patch)
       // to the original snapshot (stocks)
       console.log("udate!");
       	results = patch.events;
		if(results)
			{
			results = sortByKey(results, 'calldatetime');
			processResults(results);
			}
		checked++;
		document.getElementById('checked').innerHTML = "Updated " + checked + ' times!';

     })
     .onError(function(error) {
       // displays the error message
       console.log(error.getMessage());
     });

    // open the data stream to the REST service through streamdata.io proxy
    eventSource.open();

  };

  function disconnect() {
    if (eventSource) {
      eventSource.close();
      eventSource = null;
    }
  };

  connect();

	}

</script>
